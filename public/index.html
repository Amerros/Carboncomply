<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CarbonComply - Enterprise CO2 Rapportage Platform</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://js.stripe.com/v3/"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chart.js/3.9.1/chart.min.js"></script>
    <style>
        :root {
            --primary: #10b981;
            --primary-dark: #059669;
            --primary-light: #34d399;
            --secondary: #3b82f6;
            --accent: #8b5cf6;
            --danger: #ef4444;
            --warning: #f59e0b;
            --success: #10b981;
            --dark: #1f2937;
            --light: #f9fafb;
            --border: #e5e7eb;
            --text: #374151;
            --text-light: #6b7280;
            --white: #ffffff;
            --gradient: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background: var(--light);
            overflow-x: hidden;
        }

        /* ENHANCED HEADER */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .nav {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary);
            text-decoration: none;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--text);
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-links a:hover {
            color: var(--primary);
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: width 0.3s ease;
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        .user-menu {
            position: relative;
            display: none;
        }

        .user-menu.active {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            background: var(--gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            cursor: pointer;
        }

        .plan-badge {
            background: var(--primary);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .plan-badge.free { background: var(--text-light); }
        .plan-badge.starter { background: var(--primary); }
        .plan-badge.professional { background: var(--accent); }

        /* ENHANCED BUTTONS */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.95rem;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: var(--gradient);
            color: white;
            box-shadow: var(--shadow);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-secondary:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        .btn-ghost {
            background: transparent;
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-ghost:hover {
            background: var(--light);
            border-color: var(--primary);
        }

        /* HERO SECTION - NEXT LEVEL */
        .hero {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            color: white;
            padding: 6rem 2rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            min-height: 100vh;
            display: flex;
            align-items: center;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><defs><radialGradient id="a" cx="50%" cy="50%"><stop offset="0%" style="stop-color:rgba(16,185,129,0.3)"/><stop offset="100%" style="stop-color:rgba(16,185,129,0)"/></radialGradient></defs><circle cx="200" cy="200" r="150" fill="url(%23a)"/><circle cx="800" cy="300" r="100" fill="url(%23a)"/><circle cx="400" cy="700" r="120" fill="url(%23a)"/></svg>');
            animation: float 20s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }

        .hero-content {
            max-width: 1000px;
            margin: 0 auto;
            position: relative;
            z-index: 2;
        }

        .hero h1 {
            font-size: clamp(2.5rem, 5vw, 4rem);
            margin-bottom: 1.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, #ffffff 0%, #10b981 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
        }

        .hero-subtitle {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            opacity: 0.9;
            font-weight: 300;
        }

        .hero p {
            font-size: 1.25rem;
            margin-bottom: 3rem;
            opacity: 0.8;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-cta {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 4rem;
        }

        .hero-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            margin-top: 4rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary-light);
            margin-bottom: 0.5rem;
        }

        .stat-label {
            opacity: 0.8;
            font-weight: 500;
        }

        /* FEATURE SECTIONS */
        .features {
            padding: 6rem 2rem;
            background: white;
        }

        .features-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .section-header {
            text-align: center;
            margin-bottom: 4rem;
        }

        .section-title {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--dark) 0%, var(--primary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .section-subtitle {
            font-size: 1.25rem;
            color: var(--text-light);
            max-width: 600px;
            margin: 0 auto;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
        }

        .feature-card {
            background: white;
            border-radius: 16px;
            padding: 2.5rem;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient);
        }

        .feature-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            background: var(--gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .feature-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--dark);
        }

        .feature-description {
            color: var(--text-light);
            line-height: 1.7;
        }

        /* CALCULATOR SECTION - ENHANCED */
        .calculator {
            padding: 6rem 2rem;
            background: var(--light);
        }

        .calculator-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .calculator-card {
            background: white;
            border-radius: 20px;
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            position: relative;
        }

        .calculator-header {
            background: var(--gradient);
            color: white;
            padding: 3rem 2rem;
            text-align: center;
            position: relative;
        }

        .calculator-header::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: white;
            border-radius: 20px 20px 0 0;
        }

        .progress-container {
            margin: 2rem 0;
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.2);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .progress-fill {
            background: white;
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 20px;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3));
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-20px); }
            100% { transform: translateX(20px); }
        }

        .step-indicators {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
        }

        .step-indicator {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .step-indicator.active {
            background: white;
            color: var(--primary);
            transform: scale(1.2);
        }

        .step-indicator.completed {
            background: var(--primary-light);
        }

        .calculator-body {
            padding: 3rem 2rem;
        }

        .step {
            display: none;
            animation: fadeInUp 0.5s ease;
        }

        .step.active {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .form-group {
            margin-bottom: 2rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.75rem;
            font-weight: 600;
            color: var(--dark);
            font-size: 1.1rem;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
            transform: scale(1.02);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .input-group {
            position: relative;
        }

        .input-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
        }

        .input-group input {
            padding-left: 3rem;
        }

        .tooltip {
            position: relative;
            cursor: help;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--dark);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.875rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .tooltip:hover::after {
            opacity: 1;
            visibility: visible;
        }

        /* RESULTS SECTION - PREMIUM */
        .results {
            background: white;
            border-radius: 16px;
            padding: 3rem;
            margin: 2rem 0;
            box-shadow: var(--shadow-lg);
        }

        .executive-summary {
            background: var(--gradient);
            color: white;
            padding: 3rem;
            border-radius: 16px;
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
        }

        .executive-summary::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transform: translate(30px, -30px);
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
        }

        .summary-item {
            text-align: center;
        }

        .summary-value {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .summary-label {
            opacity: 0.9;
            font-weight: 500;
        }

        .detailed-breakdown {
            margin-top: 3rem;
        }

        .breakdown-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border);
        }

        .breakdown-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
        }

        .chart-container {
            margin: 2rem 0;
            background: var(--light);
            border-radius: 12px;
            padding: 2rem;
        }

        .chart-title {
            text-align: center;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--dark);
        }

        /* PRICING SECTION - PREMIUM */
        .pricing {
            padding: 6rem 2rem;
            background: linear-gradient(135deg, var(--light) 0%, white 100%);
        }

        .pricing-container {
            max-width: 1400px;
            margin: 0 auto;
            text-align: center;
        }

        .pricing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
            margin: 4rem 0;
        }

        .pricing-card {
            background: white;
            border: 2px solid var(--border);
            border-radius: 20px;
            padding: 3rem 2rem;
            position: relative;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .pricing-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: var(--gradient);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .pricing-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary);
        }

        .pricing-card:hover::before {
            transform: scaleX(1);
        }

        .pricing-card.featured {
            border-color: var(--primary);
            transform: scale(1.05);
            box-shadow: var(--shadow-lg);
        }

        .pricing-card.featured::before {
            transform: scaleX(1);
        }

        .pricing-badge {
            background: var(--gradient);
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
        }

        .pricing-plan {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--dark);
        }

        .pricing-price {
            font-size: 4rem;
            font-weight: 800;
            color: var(--primary);
            margin: 1.5rem 0;
            line-height: 1;
        }

        .pricing-period {
            font-size: 1rem;
            color: var(--text-light);
            font-weight: 400;
        }

        .pricing-features {
            list-style: none;
            margin: 2rem 0;
            text-align: left;
        }

        .pricing-features li {
            padding: 0.75rem 0;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .pricing-features li::before {
            content: "✓";
            background: var(--success);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
            flex-shrink: 0;
        }

        /* MODALS - PREMIUM */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 3rem;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .modal.active .modal-content {
            transform: scale(1);
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-light);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: var(--light);
            color: var(--dark);
        }

        /* LOADING STATES */
        .loading {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid transparent;
            border-top: 2px solid currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* NOTIFICATIONS */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 12px;
            padding: 1rem 1.5rem;
            box-shadow: var(--shadow-lg);
            border-left: 4px solid var(--success);
            z-index: 10001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            border-left-color: var(--danger);
        }

        .notification.warning {
            border-left-color: var(--warning);
        }

        /* RESPONSIVE DESIGN */
        @media (max-width: 768px) {
            .nav {
                padding: 1rem;
            }

            .nav-links {
                display: none;
            }

            .hero {
                padding: 4rem 1rem;
                min-height: 80vh;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .hero-cta {
                flex-direction: column;
                align-items: center;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .features-grid {
                grid-template-columns: 1fr;
            }

            .pricing-grid {
                grid-template-columns: 1fr;
            }

            .summary-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .calculator-body {
                padding: 2rem 1rem;
            }
        }

        /* ACCESSIBILITY */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* CUSTOM SCROLLBAR */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--light);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        /* PRINT STYLES */
        @media print {
            .header, .nav, .btn, .modal {
                display: none !important;
            }
            
            .results {
                box-shadow: none;
                border: 1px solid #000;
            }
        }
    </style>
</head>
<body>
    <!-- Enhanced Header -->
    <header class="header">
        <nav class="nav">
            <a href="#" class="logo">
                <div class="logo-icon">
                    <i class="fas fa-leaf"></i>
                </div>
                CarbonComply
            </a>
            
            <div class="nav-links">
                <a href="#features">Features</a>
                <a href="#calculator">Calculator</a>
                <a href="#pricing">Prijzen</a>
                <a href="#contact">Contact</a>
                <button class="btn btn-ghost" onclick="showAuthModal('login')">
                    <i class="fas fa-sign-in-alt"></i>
                    Inloggen
                </button>
                <button class="btn btn-primary" onclick="startCalculator()">
                    <i class="fas fa-calculator"></i>
                    Start Gratis
                </button>
            </div>

            <!-- User Menu (shown when logged in) -->
            <div class="user-menu" id="userMenu">
                <div class="plan-badge" id="userPlanBadge">FREE</div>
                <div class="user-avatar" id="userAvatar" onclick="toggleUserDropdown()">
                    JD
                </div>
                <div class="user-dropdown" id="userDropdown" style="display: none;">
                    <a href="#" onclick="showDashboard()">Dashboard</a>
                    <a href="#" onclick="showBilling()">Facturatie</a>
                    <a href="#" onclick="showSettings()">Instellingen</a>
                    <a href="#" onclick="logout()">Uitloggen</a>
                </div>
            </div>
        </nav>
    </header>

    <!-- Enhanced Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1>Enterprise CO2 Rapportage in 15 Minuten</h1>
            <div class="hero-subtitle">Voldoe aan Nederlandse & EU compliance zonder dure consultants</div>
            <p>Het meest geavanceerde CO2 rapportage platform voor het Nederlandse MKB. 
               Automatische berekeningen, professionele rapporten, en volledige CSRD compliance.</p>
            
            <div class="hero-cta">
                <button class="btn btn-primary" onclick="startCalculator()">
                    <i class="fas fa-rocket"></i>
                    Start Gratis Berekening
                </button>
                <button class="btn btn-secondary" onclick="showDemo()">
                    <i class="fas fa-play"></i>
                    Bekijk Demo
                </button>
            </div>

            <div class="hero-stats">
                <div class="stat-card">
                    <div class="stat-number">500+</div>
                    <div class="stat-label">Tevreden bedrijven</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">15min</div>
                    <div class="stat-label">Gemiddelde tijd</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">100%</div>
                    <div class="stat-label">Compliance rate</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">10x</div>
                    <div class="stat-label">Goedkoper dan consultants</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Enhanced Features Section -->
    <section id="features" class="features">
        <div class="features-container">
            <div class="section-header">
                <h2 class="section-title">Waarom CarbonComply?</h2>
                <p class="section-subtitle">
                    De meest complete CO2 rapportage oplossing, speciaal ontwikkeld voor het Nederlandse MKB
                </p>
            </div>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3 class="feature-title">100% Compliance Garantie</h3>
                    <p class="feature-description">
                        Volledig conform Nederlandse CO2-rapportagewet en CSRD richtlijnen. 
                        Automatische updates bij regelgevingswijzigingen.
                    </p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h3 class="feature-title">Geavanceerde Analytics</h3>
                    <p class="feature-description">
                        Real-time dashboard met benchmarking, trend analysis en 
                        actionable insights voor CO2 reductie.
                    </p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3 class="feature-title">Team Collaboration</h3>
                    <p class="feature-description">
                        Werk samen met je team, stel gebruikersrechten in en 
                        beheer multiple locaties vanuit één platform.
                    </p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <h3 class="feature-title">AI-Powered Suggestions</h3>
                    <p class="feature-description">
                        Machine learning algoritmes geven gepersonaliseerde 
                        aanbevelingen voor CO2 reductie en kostenbesparingen.
                    </p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-link"></i>
                    </div>
                    <h3 class="feature-title">API Integraties</h3>
                    <p class="feature-description">
                        Koppel met je bestaande systemen: ERP, financiële software, 
                        en energie monitoring tools.
                    </p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-headset"></i>
                    </div>
                    <h3 class="feature-title">Expert Support</h3>
                    <p class="feature-description">
                        Nederlandse support van duurzaamheidsexperts. 
                        Chat, email en telefoon ondersteuning beschikbaar.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Enhanced Calculator Section -->
    <section id="calculator" class="calculator">
        <div class="calculator-container">
            <div class="calculator-card">
                <div class="calculator-header">
                    <h2>Enterprise CO2 Calculator</h2>
                    <p>Volledige CO2 footprint analyse in 4 eenvoudige stappen</p>
                    
                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressBar" style="width: 25%"></div>
                        </div>
                        <div class="step-indicators">
                            <div class="step-indicator active" data-step="1">1</div>
                            <div class="step-indicator" data-step="2">2</div>
                            <div class="step-indicator" data-step="3">3</div>
                            <div class="step-indicator" data-step="4">4</div>
                        </div>
                        <div id="progressText">Stap 1 van 4: Bedrijfsinformatie</div>
                    </div>
                </div>

                <div class="calculator-body">
                    <!-- Step 1: Company Information -->
                    <div class="step active" id="step1">
                        <div class="breakdown-header">
                            <div class="breakdown-icon">
                                <i class="fas fa-building"></i>
                            </div>
                            <div>
                                <h3>Bedrijfsinformatie</h3>
                                <p>Vertel ons over uw organisatie</p>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="companyName">Bedrijfsnaam *</label>
                            <div class="input-group">
                                <i class="input-icon fas fa-building"></i>
                                <input type="text" id="companyName" placeholder="Uw bedrijfsnaam" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="kvkNumber">KvK Nummer</label>
                                <div class="input-group">
                                    <i class="input-icon fas fa-id-card"></i>
                                    <input type="text" id="kvkNumber" placeholder="12345678">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="employees">Aantal Werknemers *</label>
                                <select id="employees" required>
                                    <option value="">Selecteer...</option>
                                    <option value="50-100">50-100 werknemers</option>
                                    <option value="100-150">100-150 werknemers</option>
                                    <option value="150-250">150-250 werknemers</option>
                                    <option value="250-500">250-500 werknemers</option>
                                    <option value="500+">500+ werknemers</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="industry">Branche</label>
                                <select id="industry">
                                    <option value="">Selecteer branche...</option>
                                    <option value="manufacturing">Productie & Manufacturing</option>
                                    <option value="services">Dienstverlening</option>
                                    <option value="retail">Retail & Groothandel</option>
                                    <option value="logistics">Logistiek & Transport</option>
                                    <option value="construction">Bouw & Constructie</option>
                                    <option value="technology">Technologie & IT</option>
                                    <option value="healthcare">Zorg & Welzijn</option>
                                    <option value="education">Onderwijs</option>
                                    <option value="other">Anders</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="revenue">Jaaromzet (optioneel)</label>
                                <select id="revenue">
                                    <option value="">Selecteer omzet...</option>
                                    <option value="0-2M">€0 - €2M</option>
                                    <option value="2M-10M">€2M - €10M</option>
                                    <option value="10M-50M">€10M - €50M</option>
                                    <option value="50M+">€50M+</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Vehicle Fleet -->
                    <div class="step" id="step2">
                        <div class="breakdown-header">
                            <div class="breakdown-icon">
                                <i class="fas fa-car"></i>
                            </div>
                            <div>
                                <h3>Voertuigpark & Mobiliteit</h3>
                                <p>Informatie over zakelijke voertuigen</p>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="carCount" class="tooltip" data-tooltip="Personenauto's voor zakelijk gebruik">
                                    Aantal Auto's
                                </label>
                                <div class="input-group">
                                    <i class="input-icon fas fa-car"></i>
                                    <input type="number" id="carCount" min="0" value="0" placeholder="0">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="carKm" class="tooltip" data-tooltip="Totaal aantal kilometers per jaar van alle auto's">
                                    Km per jaar (totaal)
                                </label>
                                <div class="input-group">
                                    <i class="input-icon fas fa-road"></i>
                                    <input type="number" id="carKm" min="0" placeholder="50000">
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="vanCount" class="tooltip" data-tooltip="Bestelwagens en lichte vrachtwagens">
                                    Aantal Bestelwagens
                                </label>
                                <div class="input-group">
                                    <i class="input-icon fas fa-truck"></i>
                                    <input type="number" id="vanCount" min="0" value="0" placeholder="0">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="vanKm">Km per jaar (totaal)</label>
                                <div class="input-group">
                                    <i class="input-icon fas fa-road"></i>
                                    <input type="number" id="vanKm" min="0" placeholder="30000">
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="truckCount" class="tooltip" data-tooltip="Zware vrachtwagens boven 3.5 ton">
                                    Aantal Vrachtwagens
                                </label>
                                <div class="input-group">
                                    <i class="input-icon fas fa-shipping-fast"></i>
                                    <input type="number" id="truckCount" min="0" value="0" placeholder="0">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="truckKm">Km per jaar (totaal)</label>
                                <div class="input-group">
                                    <i class="input-icon fas fa-road"></i>
                                    <input type="number" id="truckKm" min="0" placeholder="100000">
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="fuelType">Hoofdzakelijk brandstoftype</label>
                            <select id="fuelType">
                                <option value="mixed">Gemengd (benzine/diesel)</option>
                                <option value="petrol">Hoofdzakelijk benzine</option>
                                <option value="diesel">Hoofdzakelijk diesel</option>
                                <option value="hybrid">Hybride voertuigen</option>
                                <option value="electric">Elektrische voertuigen</option>
                            </select>
                        </div>
                    </div>

                    <!-- Step 3: Business Travel & Energy -->
                    <div class="step" id="step3">
                        <div class="breakdown-header">
                            <div class="breakdown-icon">
                                <i class="fas fa-plane"></i>
                            </div>
                            <div>
                                <h3>Zakelijke Reizen & Energie</h3>
                                <p>Vliegreizen, treinreizen en energieverbruik</p>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="domesticFlights" class="tooltip" data-tooltip="Vluchten binnen Europa">
                                    Binnenlandse/EU Vluchten per jaar
                                </label>
                                <div class="input-group">
                                    <i class="input-icon fas fa-plane"></i>
                                    <input type="number" id="domesticFlights" min="0" value="0" placeholder="0">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="internationalFlights" class="tooltip" data-tooltip="Intercontinentale vluchten">
                                    Internationale Vluchten per jaar
                                </label>
                                <div class="input-group">
                                    <i class="input-icon fas fa-globe"></i>
                                    <input type="number" id="internationalFlights" min="0" value="0" placeholder="0">
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="trainKm" class="tooltip" data-tooltip="Zakelijke treinreizen per jaar">
                                    Trein kilometers per jaar
                                </label>
                                <div class="input-group">
                                    <i class="input-icon fas fa-train"></i>
                                    <input type="number" id="trainKm" min="0" placeholder="5000">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="hotelNights">Hotelnachten per jaar</label>
                                <div class="input-group">
                                    <i class="input-icon fas fa-bed"></i>
                                    <input type="number" id="hotelNights" min="0" placeholder="50">
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="commuting">Woon-werk verkeer inschatting</label>
                            <select id="commuting">
                                <option value="low">Laag - Veel thuiswerk/openbaar vervoer (1-2 dagen kantoor)</option>
                                <option value="medium" selected>Gemiddeld - Hybride werken (3 dagen kantoor)</option>
                                <option value="high">Hoog - Vooral auto gebruik (4-5 dagen kantoor)</option>
                            </select>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="electricity" class="tooltip" data-tooltip="Check uw energierekening voor exacte verbruik">
                                    Elektriciteit (kWh/jaar)
                                </label>
                                <div class="input-group">
                                    <i class="input-icon fas fa-bolt"></i>
                                    <input type="number" id="electricity" min="0" placeholder="150000">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="gas" class="tooltip" data-tooltip="Aardgas voor verwarming en warm water">
                                    Gas (m³/jaar)
                                </label>
                                <div class="input-group">
                                    <i class="input-icon fas fa-fire"></i>
                                    <input type="number" id="gas" min="0" placeholder="25000">
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="renewableEnergy">Percentage groene energie</label>
                            <select id="renewableEnergy">
                                <option value="0">0% - Grijze stroom</option>
                                <option value="25">25% - Gedeeltelijk groen</option>
                                <option value="50">50% - Half groen</option>
                                <option value="75">75% - Grotendeels groen</option>
                                <option value="100">100% - Volledig groene energie</option>
                            </select>
                        </div>
                    </div>

                    <!-- Step 4: Results -->
                    <div class="step" id="step4">
                        <div class="breakdown-header">
                            <div class="breakdown-icon">
                                <i class="fas fa-chart-pie"></i>
                            </div>
                            <div>
                                <h3>Uw Complete CO2 Impact Rapport</h3>
                                <p>Professionele analyse met actionable insights</p>
                            </div>
                        </div>
                        
                        <!-- Executive Summary -->
                        <div class="executive-summary">
                            <h4 style="margin-bottom: 2rem; font-size: 1.8rem;">
                                <i class="fas fa-chart-line"></i>
                                Executive Dashboard
                            </h4>
                            <div class="summary-grid">
                                <div class="summary-item">
                                    <div class="summary-value" id="totalEmissionsSummary">...</div>
                                    <div class="summary-label">Totale CO2 uitstoot (ton/jaar)</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-value" id="perEmployeeSummary">...</div>
                                    <div class="summary-label">Ton CO2 per werknemer</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-value" id="complianceScore">A+</div>
                                    <div class="summary-label">Compliance Score</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-value" id="reductionPotential">...</div>
                                    <div class="summary-label">Reductie potentieel (%)</div>
                                </div>
                            </div>
                        </div>

                        <!-- Interactive Charts -->
                        <div class="chart-container">
                            <h5 class="chart-title">CO2 Uitstoot per Categorie</h5>
                            <canvas id="emissionsChart" width="400" height="200"></canvas>
                        </div>

                        <div class="chart-container">
                            <h5 class="chart-title">Benchmark Vergelijking</h5>
                            <canvas id="benchmarkChart" width="400" height="200"></canvas>
                        </div>

                        <!-- Download Section -->
                        <div style="background: white; padding: 3rem; border-radius: 16px; box-shadow: var(--shadow-lg); margin-top: 2rem;">
                            <h4 style="margin-bottom: 1.5rem; text-align: center;">
                                <i class="fas fa-download"></i>
                                Download Uw Professional Rapport
                            </h4>
                            <p style="color: var(--text-light); margin-bottom: 2rem; text-align: center;">
                                Enterprise-grade PDF rapport met alle analyses, grafieken en compliance documentatie
                            </p>
                            <div style="display: flex; gap: 1.5rem; justify-content: center; flex-wrap: wrap;">
                                <button class="btn btn-primary" onclick="downloadProfessionalReport()" style="font-size: 1.1rem; padding: 1rem 2rem;">
                                    <i class="fas fa-file-pdf"></i>
                                    Download Professional PDF
                                </button>
                                <button class="btn btn-secondary" onclick="downloadExcelReport()" style="font-size: 1.1rem; padding: 1rem 2rem;">
                                    <i class="fas fa-file-excel"></i>
                                    Download Excel Data
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation Controls -->
                    <div style="display: flex; justify-content: space-between; margin-top: 3rem; padding-top: 2rem; border-top: 2px solid var(--border);">
                        <button class="btn btn-ghost" id="prevBtn" onclick="previousStep()" style="display: none;">
                            <i class="fas fa-arrow-left"></i>
                            Vorige
                        </button>
                        <button class="btn btn-primary" id="nextBtn" onclick="nextStep()">
                            Volgende
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Enhanced Pricing Section -->
    <section id="pricing" class="pricing">
        <div class="pricing-container">
            <div class="section-header">
                <h2 class="section-title">Transparante Prijzen</h2>
                <p class="section-subtitle">
                    Kies het plan dat perfect past bij uw organisatie. Alle plannen bevatten Nederlandse compliance.
                </p>
            </div>
            
            <div class="pricing-grid">
                <!-- Free Tier -->
                <div class="pricing-card">
                    <h3 class="pricing-plan">
                        <i class="fas fa-gift"></i>
                        Gratis Proef
                    </h3>
                    <div class="pricing-price">
                        €0
                        <span class="pricing-period">/maand</span>
                    </div>
                    <ul class="pricing-features">
                        <li>1 complete CO2 berekening per maand</li>
                        <li>Basis PDF rapport (met watermark)</li>
                        <li>Nederlandse compliance check</li>
                        <li>Email ondersteuning</li>
                        <li>Benchmarking met sector gemiddelde</li>
                        <li>7 dagen data opslag</li>
                    </ul>
                    <button class="btn btn-ghost" onclick="startCalculator()">
                        <i class="fas fa-rocket"></i>
                        Start Gratis
                    </button>
                </div>

                <!-- Starter Plan -->
                <div class="pricing-card featured">
                    <div class="pricing-badge">
                        <i class="fas fa-star"></i>
                        Populair
                    </div>
                    <h3 class="pricing-plan">
                        <i class="fas fa-building"></i>
                        Starter
                    </h3>
                    <div class="pricing-price">
                        €49
                        <span class="pricing-period">/maand</span>
                    </div>
                    <ul class="pricing-features">
                        <li>Onbeperkte CO2 berekeningen</li>
                        <li>Professional PDF rapporten (geen watermark)</li>
                        <li>Excel & CSV data export</li>
                        <li>1 jaar data opslag & trending</li>
                        <li>Priority email & chat support</li>
                        <li>Deadline herinneringen</li>
                        <li>Basis API toegang</li>
                        <li>Sector benchmarking & insights</li>
                    </ul>
                    <button class="btn btn-primary" onclick="subscribeToPlan('starter')">
                        <i class="fas fa-credit-card"></i>
                        Kies Starter
                    </button>
                </div>

                <!-- Professional Plan -->
                <div class="pricing-card">
                    <h3 class="pricing-plan">
                        <i class="fas fa-crown"></i>
                        Professional
                    </h3>
                    <div class="pricing-price">
                        €89
                        <span class="pricing-period">/maand</span>
                    </div>
                    <ul class="pricing-features">
                        <li>Alles van Starter plan</li>
                        <li>CSRD compliance voorbereiding</li>
                        <li>Team collaboration (5 gebruikers)</li>
                        <li>Advanced API integraties</li>
                        <li>White-label rapporten</li>
                        <li>Telefoon support (NL werktijden)</li>
                        <li>Custom branding</li>
                        <li>Multi-locatie management</li>
                        <li>Audit trail & compliance logging</li>
                    </ul>
                    <button class="btn btn-primary" onclick="subscribeToPlan('professional')">
                        <i class="fas fa-crown"></i>
                        Kies Professional
                    </button>
                </div>

                <!-- Enterprise Plan -->
                <div class="pricing-card">
                    <h3 class="pricing-plan">
                        <i class="fas fa-rocket"></i>
                        Enterprise
                    </h3>
                    <div class="pricing-price">
                        Custom
                        <span class="pricing-period">pricing</span>
                    </div>
                    <ul class="pricing-features">
                        <li>Alles van Professional plan</li>
                        <li>Onbeperkte gebruikers</li>
                        <li>On-premise deployment optie</li>
                        <li>Custom integrations & development</li>
                        <li>Dedicated account manager</li>
                        <li>24/7 priority support</li>
                        <li>SLA garanties</li>
                        <li>Training & onboarding</li>
                        <li>Advanced security & compliance</li>
                    </ul>
                    <button class="btn btn-secondary" onclick="contactSales()">
                        <i class="fas fa-phone"></i>
                        Contact Sales
                    </button>
                </div>
            </div>

            <!-- One-time Report Option -->
            <div style="margin-top: 3rem; text-align: center; background: white; padding: 2rem; border-radius: 16px; box-shadow: var(--shadow);">
                <h3 style="margin-bottom: 1rem;">
                    <i class="fas fa-file-alt"></i>
                    Eenmalig Professional Rapport
                </h3>
                <p style="color: var(--text-light); margin-bottom: 2rem;">
                    Heb je maar één rapport nodig? Koop een professional PDF rapport zonder abonnement.
                </p>
                <div style="font-size: 2rem; font-weight: 800; color: var(--primary); margin-bottom: 1rem;">
                    €19 <span style="font-size: 1rem; font-weight: 400; color: var(--text-light);">per rapport</span>
                </div>
                <button class="btn btn-primary" onclick="buyOneTimeReport()">
                    <i class="fas fa-shopping-cart"></i>
                    Koop Eenmalig Rapport
                </button>
            </div>
        </div>
    </section>

    <!-- Auth Modal -->
    <div id="authModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('authModal')">&times;</button>
            
            <!-- Login Form -->
            <div id="loginForm">
                <h3 style="margin-bottom: 2rem; text-align: center;">
                    <i class="fas fa-sign-in-alt"></i>
                    Inloggen op CarbonComply
                </h3>
                
                <div class="form-group">
                    <label for="loginEmail">Email adres</label>
                    <div class="input-group">
                        <i class="input-icon fas fa-envelope"></i>
                        <input type="email" id="loginEmail" placeholder="naam@bedrijf.nl" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="loginPassword">Wachtwoord</label>
                    <div class="input-group">
                        <i class="input-icon fas fa-lock"></i>
                        <input type="password" id="loginPassword" placeholder="Uw wachtwoord" required>
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="handleLogin()" style="width: 100%; margin-bottom: 1rem;">
                    <i class="fas fa-sign-in-alt"></i>
                    Inloggen
                </button>
                
                <p style="text-align: center;">
                    <a href="#" onclick="showAuthForm('register')" style="color: var(--primary);">
                        Nog geen account? Registreer hier
                    </a>
                </p>
            </div>
            
            <!-- Register Form -->
            <div id="registerForm" style="display: none;">
                <h3 style="margin-bottom: 2rem; text-align: center;">
                    <i class="fas fa-user-plus"></i>
                    Account Aanmaken
                </h3>
                
                <div class="form-group">
                    <label for="registerCompany">Bedrijfsnaam</label>
                    <div class="input-group">
                        <i class="input-icon fas fa-building"></i>
                        <input type="text" id="registerCompany" placeholder="Uw bedrijfsnaam" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="registerEmail">Email adres</label>
                    <div class="input-group">
                        <i class="input-icon fas fa-envelope"></i>
                        <input type="email" id="registerEmail" placeholder="naam@bedrijf.nl" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="registerPassword">Wachtwoord</label>
                    <div class="input-group">
                        <i class="input-icon fas fa-lock"></i>
                        <input type="password" id="registerPassword" placeholder="Minimaal 8 karakters" required>
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="handleRegister()" style="width: 100%; margin-bottom: 1rem;">
                    <i class="fas fa-user-plus"></i>
                    Account Aanmaken
                </button>
                
                <p style="text-align: center;">
                    <a href="#" onclick="showAuthForm('login')" style="color: var(--primary);">
                        Al een account? Log hier in
                    </a>
                </p>
            </div>
        </div>
    </div>

    <!-- Payment Modal -->
    <div id="paymentModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('paymentModal')">&times;</button>
            <h3 style="margin-bottom: 2rem; text-align: center;">
                <i class="fas fa-credit-card"></i>
                Upgrade naar Professional
            </h3>
            
            <div id="paymentOptions">
                <div style="border: 2px solid var(--primary); border-radius: 12px; padding: 2rem; margin-bottom: 2rem;">
                    <h4 style="color: var(--primary); margin-bottom: 1rem;">
                        <i class="fas fa-file-alt"></i>
                        Eenmalig Professional Rapport - €19
                    </h4>
                    <ul style="list-style: none; margin-bottom: 1.5rem;">
                        <li>✓ Professional PDF zonder watermark</li>
                        <li>✓ Excel data export</li>
                        <li>✓ Direct toegang</li>
                        <li>✓ Geen abonnement</li>
                    </ul>
                    <button class="btn btn-secondary" onclick="processOneTimePayment()" style="width: 100%;">
                        <i class="fas fa-shopping-cart"></i>
                        Koop voor €19
                    </button>
                </div>
                
                <div style="border: 2px solid var(--success); border-radius: 12px; padding: 2rem;">
                    <h4 style="color: var(--success); margin-bottom: 1rem;">
                        <i class="fas fa-crown"></i>
                        Starter Abonnement - €49/maand
                    </h4>
                    <ul style="list-style: none; margin-bottom: 1.5rem;">
                        <li>✓ Onbeperkte professional rapporten</li>
                        <li>✓ Geen watermarks</li>
                        <li>✓ Priority support</li>
                        <li>✓ 1 jaar data opslag</li>
                        <li>✓ Deadline herinneringen</li>
                    </ul>
                    <button class="btn btn-primary" onclick="createSubscription('starter')" style="width: 100%;">
                        <i class="fas fa-rocket"></i>
                        Start Abonnement
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer style="background: var(--dark); color: white; padding: 4rem 2rem 2rem;">
        <div style="max-width: 1400px; margin: 0 auto;">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 3rem; margin-bottom: 3rem;">
                <div>
                    <div class="logo" style="color: white; margin-bottom: 1rem;">
                        <div class="logo-icon">
                            <i class="fas fa-leaf"></i>
                        </div>
                        CarbonComply
                    </div>
                    <p style="color: rgba(255,255,255,0.8); line-height: 1.7;">
                        Het meest geavanceerde CO2 rapportage platform voor Nederlandse bedrijven. 
                        Compliance, analytics en sustainability in één oplossing.
                    </p>
                </div>
                
                <div>
                    <h4 style="margin-bottom: 1rem;">Product</h4>
                    <ul style="list-style: none;">
                        <li style="margin-bottom: 0.5rem;"><a href="#features" style="color: rgba(255,255,255,0.8); text-decoration: none;">Features</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="#pricing" style="color: rgba(255,255,255,0.8); text-decoration: none;">Prijzen</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="#" style="color: rgba(255,255,255,0.8); text-decoration: none;">API</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="#" style="color: rgba(255,255,255,0.8); text-decoration: none;">Integraties</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 style="margin-bottom: 1rem;">Bedrijf</h4>
                    <ul style="list-style: none;">
                        <li style="margin-bottom: 0.5rem;"><a href="#" style="color: rgba(255,255,255,0.8); text-decoration: none;">Over ons</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="#" style="color: rgba(255,255,255,0.8); text-decoration: none;">Careers</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="#" style="color: rgba(255,255,255,0.8); text-decoration: none;">Contact</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="#" style="color: rgba(255,255,255,0.8); text-decoration: none;">Blog</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 style="margin-bottom: 1rem;">Support</h4>
                    <ul style="list-style: none;">
                        <li style="margin-bottom: 0.5rem;"><a href="#" style="color: rgba(255,255,255,0.8); text-decoration: none;">Help Center</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="#" style="color: rgba(255,255,255,0.8); text-decoration: none;">Privacy Policy</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="#" style="color: rgba(255,255,255,0.8); text-decoration: none;">Terms of Service</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="#" style="color: rgba(255,255,255,0.8); text-decoration: none;">Status</a></li>
                    </ul>
                </div>
            </div>
            
            <div style="border-top: 1px solid rgba(255,255,255,0.2); padding-top: 2rem; text-align: center;">
                <p style="color: rgba(255,255,255,0.6);">
                    © 2024 CarbonComply. Alle rechten voorbehouden. Made with 🌱 in Netherlands.
                </p>
            </div>
        </div>
    </footer>

    <script>
        // ===== APPLICATION STATE MANAGEMENT =====
        class AppState {
            constructor() {
                this.user = null;
                this.plan = 'free';
                this.reportCount = 0;
                this.calculations = [];
                this.currentCalculation = null;
                this.loadState();
            }

            loadState() {
                const saved = localStorage.getItem('carbonComplyState');
                if (saved) {
                    const state = JSON.parse(saved);
                    this.user = state.user;
                    this.plan = state.plan || 'free';
                    this.reportCount = state.reportCount || 0;
                    this.calculations = state.calculations || [];
                }
                this.updateUI();
            }

            saveState() {
                const state = {
                    user: this.user,
                    plan: this.plan,
                    reportCount: this.reportCount,
                    calculations: this.calculations
                };
                localStorage.setItem('carbonComplyState', JSON.stringify(state));
            }

            login(email, plan = 'free') {
                this.user = email;
                this.plan = plan;
                this.saveState();
                this.updateUI();
                showNotification('Succesvol ingelogd!', 'success');
            }

            logout() {
                this.user = null;
                this.plan = 'free';
                this.reportCount = 0;
                this.calculations = [];
                localStorage.removeItem('carbonComplyState');
                this.updateUI();
                showNotification('Uitgelogd', 'info');
            }

            upgradePlan(newPlan) {
                this.plan = newPlan;
                this.reportCount = 0; // Reset for paid users
                this.saveState();
                this.updateUI();
                showNotification(`Geüpgraded naar ${newPlan}!`, 'success');
            }

            canDownloadReport() {
                if (this.plan === 'starter' || this.plan === 'professional') {
                    return true;
                }
                return this.reportCount < 1; // Free users: 1 per month
            }

            incrementReportCount() {
                if (this.plan === 'free') {
                    this.reportCount++;
                    this.saveState();
                }
            }

            updateUI() {
                // Update navigation
                const navLinks = document.querySelector('.nav-links');
                const userMenu = document.querySelector('.user-menu');
                
                if (this.user) {
                    navLinks.style.display = 'none';
                    userMenu.style.display = 'flex';
                    userMenu.classList.add('active');
                    
                    // Update user avatar
                    const avatar = document.getElementById('userAvatar');
                    const initials = this.user.split('@')[0].substring(0, 2).toUpperCase();
                    avatar.textContent = initials;
                    
                    // Update plan badge
                    const badge = document.getElementById('userPlanBadge');
                    badge.textContent = this.plan.toUpperCase();
                    badge.className = `plan-badge ${this.plan}`;
                } else {
                    navLinks.style.display = 'flex';
                    userMenu.style.display = 'none';
                    userMenu.classList.remove('active');
                }

                // Update download button text
                this.updateDownloadButton();
            }

            updateDownloadButton() {
                const downloadBtns = document.querySelectorAll('[onclick*="downloadProfessionalReport"]');
                downloadBtns.forEach(btn => {
                    if (this.user) {
                        if (this.plan === 'free') {
                            const remaining = 1 - this.reportCount;
                            btn.innerHTML = `<i class="fas fa-file-pdf"></i> Download Gratis Rapport (${remaining} over)`;
                            btn.disabled = remaining <= 0;
                        } else {
                            btn.innerHTML = '<i class="fas fa-file-pdf"></i> Download Professional PDF';
                            btn.disabled = false;
                        }
                    } else {
                        btn.innerHTML = '<i class="fas fa-file-pdf"></i> Inloggen Vereist';
                    }
                });
            }
        }

        // ===== CALCULATOR LOGIC =====
        class Calculator {
            constructor() {
                this.currentStep = 1;
                this.maxSteps = 4;
                this.data = {};
                this.results = null;
                this.emissionFactors = {
                    // Enhanced emission factors
                    car: 0.18, // kg CO2 per km
                    van: 0.25,
                    truck: 0.8,
                    domesticFlight: 200, // kg CO2 per flight
                    internationalFlight: 1200,
                    train: 0.04,
                    hotel: 30, // kg CO2 per night
                    electricity: 0.4, // kg CO2 per kWh (Dutch grid)
                    gas: 1.88, // kg CO2 per m³
                    commuting: {
                        low: 800,
                        medium: 1800,
                        high: 3200
                    },
                    fuelFactors: {
                        mixed: 1.0,
                        petrol: 0.9,
                        diesel: 1.1,
                        hybrid: 0.6,
                        electric: 0.1
                    }
                };
                this.initializeEventListeners();
            }

            initializeEventListeners() {
                // Form validation
                document.querySelectorAll('input, select').forEach(field => {
                    field.addEventListener('input', () => this.validateField(field));
                });

                // Auto-save data
                document.querySelectorAll('input, select').forEach(field => {
                    field.addEventListener('change', () => this.saveCurrentData());
                });
            }

            validateField(field) {
                const value = field.value.trim();
                const isRequired = field.hasAttribute('required');
                
                if (isRequired && !value) {
                    field.style.borderColor = 'var(--danger)';
                    return false;
                } else {
                    field.style.borderColor = 'var(--border)';
                    return true;
                }
            }

            saveCurrentData() {
                // Save current form data
                this.data = this.collectFormData();
            }

            collectFormData() {
                return {
                    // Step 1
                    companyName: document.getElementById('companyName')?.value || '',
                    kvkNumber: document.getElementById('kvkNumber')?.value || '',
                    employees: document.getElementById('employees')?.value || '',
                    industry: document.getElementById('industry')?.value || '',
                    revenue: document.getElementById('revenue')?.value || '',
                    
                    // Step 2
                    carCount: parseInt(document.getElementById('carCount')?.value) || 0,
                    carKm: parseInt(document.getElementById('carKm')?.value) || 0,
                    vanCount: parseInt(document.getElementById('vanCount')?.value) || 0,
                    vanKm: parseInt(document.getElementById('vanKm')?.value) || 0,
                    truckCount: parseInt(document.getElementById('truckCount')?.value) || 0,
                    truckKm: parseInt(document.getElementById('truckKm')?.value) || 0,
                    fuelType: document.getElementById('fuelType')?.value || 'mixed',
                    
                    // Step 3
                    domesticFlights: parseInt(document.getElementById('domesticFlights')?.value) || 0,
                    internationalFlights: parseInt(document.getElementById('internationalFlights')?.value) || 0,
                    trainKm: parseInt(document.getElementById('trainKm')?.value) || 0,
                    hotelNights: parseInt(document.getElementById('hotelNights')?.value) || 0,
                    commuting: document.getElementById('commuting')?.value || 'medium',
                    electricity: parseInt(document.getElementById('electricity')?.value) || 0,
                    gas: parseInt(document.getElementById('gas')?.value) || 0,
                    renewableEnergy: parseInt(document.getElementById('renewableEnergy')?.value) || 0
                };
            }

            calculate() {
                this.data = this.collectFormData();
                
                const employeeCount = this.getEmployeeCount(this.data.employees);
                const fuelFactor = this.emissionFactors.fuelFactors[this.data.fuelType];
                
                // Calculate emissions by category (in kg CO2)
                const vehicleEmissions = (
                    (this.data.carKm * this.emissionFactors.car) +
                    (this.data.vanKm * this.emissionFactors.van) +
                    (this.data.truckKm * this.emissionFactors.truck)
                ) * fuelFactor;

                const travelEmissions = 
                    (this.data.domesticFlights * this.emissionFactors.domesticFlight) +
                    (this.data.internationalFlights * this.emissionFactors.internationalFlight) +
                    (this.data.trainKm * this.emissionFactors.train) +
                    (this.data.hotelNights * this.emissionFactors.hotel);

                const commutingEmissions = employeeCount * this.emissionFactors.commuting[this.data.commuting];

                // Adjust electricity for renewable percentage
                const electricityFactor = this.emissionFactors.electricity * (1 - this.data.renewableEnergy / 100);
                const energyEmissions = 
                    (this.data.electricity * electricityFactor) +
                    (this.data.gas * this.emissionFactors.gas);

                const totalEmissions = vehicleEmissions + travelEmissions + commutingEmissions + energyEmissions;
                const totalTons = Math.round(totalEmissions / 1000 * 10) / 10;
                const perEmployee = Math.round(totalTons / employeeCount * 10) / 10;

                this.results = {
                    ...this.data,
                    employeeCount,
                    totalEmissions: totalTons,
                    perEmployee: perEmployee,
                    breakdown: {
                        vehicles: Math.round(vehicleEmissions / 1000 * 10) / 10,
                        travel: Math.round(travelEmissions / 1000 * 10) / 10,
                        commuting: Math.round(commutingEmissions / 1000 * 10) / 10,
                        energy: Math.round(energyEmissions / 1000 * 10) / 10
                    },
                    scopes: this.calculateScopes(vehicleEmissions, energyEmissions, travelEmissions, commutingEmissions),
                    benchmarks: this.calculateBenchmarks(perEmployee, this.data.industry),
                    recommendations: this.generateRecommendations()
                };

                appState.currentCalculation = this.results;
                appState.calculations.push(this.results);
                appState.saveState();

                this.displayResults();
                this.createCharts();
            }

            getEmployeeCount(range) {
                const mapping = {
                    '50-100': 75,
                    '100-150': 125,
                    '150-250': 200,
                    '250-500': 375,
                    '500+': 750
                };
                return mapping[range] || 125;
            }

            calculateScopes(vehicleEmissions, energyEmissions, travelEmissions, commutingEmissions) {
                const scope1 = (vehicleEmissions * 0.9 + energyEmissions * 0.3) / 1000; // Direct emissions
                const scope2 = (energyEmissions * 0.7) / 1000; // Energy indirect
                const scope3 = (commutingEmissions + travelEmissions + vehicleEmissions * 0.1) / 1000; // Other indirect
                
                return {
                    scope1: Math.round(scope1 * 10) / 10,
                    scope2: Math.round(scope2 * 10) / 10,
                    scope3: Math.round(scope3 * 10) / 10
                };
            }

            calculateBenchmarks(perEmployee, industry) {
                const industryAverages = {
                    manufacturing: 7.2,
                    services: 3.8,
                    retail: 3.2,
                    logistics: 9.1,
                    construction: 6.4,
                    technology: 2.9,
                    healthcare: 4.1,
                    education: 3.5,
                    other: 4.5
                };

                const industryAvg = industryAverages[industry] || 4.5;
                const nlAverage = 4.2;
                const bestPractice = 2.1;

                return {
                    company: perEmployee,
                    industry: industryAvg,
                    national: nlAverage,
                    bestPractice: bestPractice,
                    performance: perEmployee <= industryAvg ? 'above' : 'below'
                };
            }

            generateRecommendations() {
                const recommendations = [];
                const breakdown = this.results.breakdown;

                // Vehicle recommendations
                if (breakdown.vehicles > 5) {
                    recommendations.push({
                        category: 'Mobiliteit',
                        action: 'Elektrische voertuigen (50% van vloot)',
                        impact: Math.round(breakdown.vehicles * 0.4 * 10) / 10,
                        cost: '€150.000',
                        payback: '3-5 jaar',
                        priority: 'high'
                    });
                }

                // Energy recommendations
                if (breakdown.energy > 8) {
                    recommendations.push({
                        category: 'Energie',
                        action: 'Zonnepanelen installatie',
                        impact: Math.round(breakdown.energy * 0.3 * 10) / 10,
                        cost: '€75.000',
                        payback: '7-9 jaar',
                        priority: 'medium'
                    });
                }

                // Always include renewable energy
                recommendations.push({
                    category: 'Energie',
                    action: 'Overstap naar 100% groene energie',
                    impact: Math.round(breakdown.energy * 0.5 * 10) / 10,
                    cost: '€2.000/jaar extra',
                    payback: 'Direct',
                    priority: 'high'
                });

                return recommendations;
            }

            displayResults() {
                // Update summary values
                document.getElementById('totalEmissionsSummary').textContent = this.results.totalEmissions;
                document.getElementById('perEmployeeSummary').textContent = this.results.perEmployee;
                
                // Calculate and display scores
                const reductionPotential = Math.min(85, Math.max(15, Math.round(this.results.totalEmissions / this.results.perEmployee * 8)));
                document.getElementById('reductionPotential').textContent = reductionPotential;
                
                // Compliance score
                const complianceScore = this.results.perEmployee <= 4.2 ? 'A+' : this.results.perEmployee <= 6.0 ? 'A' : 'B+';
                document.getElementById('complianceScore').textContent = complianceScore;
            }

            createCharts() {
                this.createEmissionsChart();
                this.createBenchmarkChart();
            }

            createEmissionsChart() {
                const ctx = document.getElementById('emissionsChart');
                if (!ctx) return;

                const breakdown = this.results.breakdown;
                
                new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Zakelijk Vervoer', 'Energie Verbruik', 'Woon-werk Verkeer', 'Zakelijke Reizen'],
                        datasets: [{
                            data: [breakdown.vehicles, breakdown.energy, breakdown.commuting, breakdown.travel],
                            backgroundColor: [
                                '#ef4444',
                                '#f59e0b',
                                '#10b981',
                                '#3b82f6'
                            ],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }

            createBenchmarkChart() {
                const ctx = document.getElementById('benchmarkChart');
                if (!ctx) return;

                const benchmarks = this.results.benchmarks;
                
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Uw Bedrijf', 'Branche Gem.', 'NL Gem.', 'Best Practice'],
                        datasets: [{
                            data: [benchmarks.company, benchmarks.industry, benchmarks.national, benchmarks.bestPractice],
                            backgroundColor: [
                                '#3b82f6',
                                '#6b7280',
                                '#f59e0b',
                                '#10b981'
                            ],
                            borderRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'ton CO2/werknemer'
                                }
                            }
                        }
                    }
                });
            }

            nextStep() {
                if (this.validateCurrentStep()) {
                    if (this.currentStep === 3) {
                        this.calculate();
                    }
                    
                    if (this.currentStep < this.maxSteps) {
                        this.showStep(this.currentStep + 1);
                    }
                }
            }

            previousStep() {
                if (this.currentStep > 1) {
                    this.showStep(this.currentStep - 1);
                }
            }

            showStep(stepNumber) {
                // Hide current step
                document.getElementById(`step${this.currentStep}`).classList.remove('active');
                
                // Update step number
                this.currentStep = stepNumber;
                
                // Show new step
                document.getElementById(`step${this.currentStep}`).classList.add('active');
                
                // Update progress
                this.updateProgress();
                this.updateButtons();
                this.updateStepIndicators();
                
                // Scroll to top of calculator
                document.getElementById('calculator').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

            updateProgress() {
                const progress = (this.currentStep / this.maxSteps) * 100;
                document.getElementById('progressBar').style.width = progress + '%';
                
                const stepTitles = [
                    'Bedrijfsinformatie',
                    'Voertuigpark & Mobiliteit', 
                    'Reizen & Energie',
                    'Resultaten & Rapport'
                ];
                document.getElementById('progressText').textContent = `Stap ${this.currentStep} van ${this.maxSteps}: ${stepTitles[this.currentStep - 1]}`;
            }

            updateButtons() {
                const prevBtn = document.getElementById('prevBtn');
                const nextBtn = document.getElementById('nextBtn');
                
                prevBtn.style.display = this.currentStep === 1 ? 'none' : 'block';
                
                if (this.currentStep === this.maxSteps) {
                    nextBtn.style.display = 'none';
                } else {
                    nextBtn.style.display = 'block';
                    nextBtn.innerHTML = this.currentStep === 3 
                        ? '<i class="fas fa-calculator"></i> Bereken CO2' 
                        : 'Volgende <i class="fas fa-arrow-right"></i>';
                }
            }

            updateStepIndicators() {
                document.querySelectorAll('.step-indicator').forEach((indicator, index) => {
                    const stepNum = index + 1;
                    indicator.classList.remove('active', 'completed');
                    
                    if (stepNum === this.currentStep) {
                        indicator.classList.add('active');
                    } else if (stepNum < this.currentStep) {
                        indicator.classList.add('completed');
                        indicator.innerHTML = '<i class="fas fa-check"></i>';
                    } else {
                        indicator.textContent = stepNum;
                    }
                });
            }

            validateCurrentStep() {
                const requiredFields = {
                    1: ['companyName', 'employees'],
                    2: [],
                    3: []
                };

                const fields = requiredFields[this.currentStep] || [];
                let valid = true;
                
                fields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    if (!field.value.trim()) {
                        this.validateField(field);
                        field.focus();
                        valid = false;
                        showNotification(`Vul ${field.previousElementSibling.textContent} in`, 'error');
                    }
                });
                
                return valid;
            }
        }

        // ===== PAYMENT SYSTEM =====
        class PaymentManager {
            constructor() {
                this.stripe = Stripe(STRIPE_PUBLISHABLE_KEY); // You'll need to set this
            }

            async createSubscription(plan) {
                if (!appState.user) {
                    showAuthModal('register');
                    return;
                }

                showLoadingState('Betalingslink wordt aangemaakt...');
                
                try {
                    const response = await fetch('/api/create-subscription', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${this.getAuthToken()}`
                        },
                        body: JSON.stringify({
                            plan: plan,
                            userEmail: appState.user
                        })
                    });

                    const { url } = await response.json();
                    window.location.href = url;
                    
                } catch (error) {
                    console.error('Subscription error:', error);
                    showNotification('Er ging iets mis met de betaling. Probeer het opnieuw.', 'error');
                    hideLoadingState();
                }
            }

            async processOneTimePayment() {
                if (!appState.user) {
                    showAuthModal('register');
                    return;
                }

                if (!calculator.results) {
                    showNotification('Voltooi eerst de CO2 berekening', 'error');
                    return;
                }

                showLoadingState('Betaling wordt verwerkt...');
                
                try {
                    const response = await fetch('/api/create-payment', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${this.getAuthToken()}`
                        },
                        body: JSON.stringify({
                            amount: 1900, // €19.00
                            currency: 'eur',
                            description: 'CO2 Professional Report',
                            userEmail: appState.user,
                            calculationId: Date.now()
                        })
                    });

                    const { clientSecret } = await response.json();
                    
                    const { error } = await this.stripe.confirmCardPayment(clientSecret, {
                        payment_method: {
                            card: this.cardElement,
                            billing_details: {
                                email: appState.user,
                            },
                        }
                    });

                    if (error) {
                        showNotification('Betaling mislukt: ' + error.message, 'error');
                    } else {
                        showNotification('Betaling succesvol! Rapport wordt gedownload...', 'success');
                        downloadProfessionalReport(true); // true = paid version
                        closeModal('paymentModal');
                    }
                    
                } catch (error) {
                    console.error('Payment error:', error);
                    showNotification('Er ging iets mis met de betaling. Probeer het opnieuw.', 'error');
                } finally {
                    hideLoadingState();
                }
            }

            getAuthToken() {
                // In a real app, you'd get this from your auth system
                return localStorage.getItem('authToken') || '';
            }
        }

        // ===== PDF REPORT GENERATOR =====
        class ReportGenerator {
            constructor() {
                this.jsPDF = window.jspdf.jsPDF;
            }

            async generateProfessionalReport(isPaid = false) {
                if (!calculator.results) {
                    showNotification('Geen berekening gevonden. Voltooi eerst de calculator.', 'error');
                    return;
                }

                showLoadingState('Professional rapport wordt gegenereerd...');

                try {
                    const doc = new this.jsPDF();
                    const results = calculator.results;
                    
                    // Enhanced PDF generation with professional design
                    await this.createModernHeader(doc, results);
                    await this.createExecutiveSummary(doc, results);
                    await this.createDetailedAnalysis(doc, results);
                    await this.createRecommendations(doc, results);
                    await this.createFinancialImpact(doc, results);
                    
                    if (!isPaid) {
                        this.addWatermark(doc);
                    }

                    // Save the PDF
                    const filename = `CO2-Professional-Report-${results.companyName.replace(/\s+/g, '-')}-${new Date().toLocaleDateString('nl-NL').replace(/\//g, '-')}.pdf`;
                    doc.save(filename);

                    // Track usage
                    if (appState.plan === 'free' && !isPaid) {
                        appState.incrementReportCount();
                    }

                    showNotification('Professional rapport gedownload!', 'success');
                    
                } catch (error) {
                    console.error('PDF generation error:', error);
                    showNotification('Er ging iets mis bij het genereren van het rapport.', 'error');
                } finally {
                    hideLoadingState();
                }
            }

            async createModernHeader(doc, results) {
                // Modern gradient header
                doc.setFillColor(15, 23, 42);
                doc.rect(0, 0, 210, 50, 'F');
                
                // Company logo placeholder
                doc.setFillColor(16, 185, 129);
                doc.circle(25, 25, 12, 'F');
                doc.setTextColor(255, 255, 255);
                doc.setFontSize(16);
                doc.text('CC', 20, 29);
                
                // Title
                doc.setTextColor(255, 255, 255);
                doc.setFontSize(24);
                doc.text('CO2 IMPACT RAPPORT', 45, 20);
                doc.setFontSize(12);
                doc.text('Enterprise Carbon Footprint Analysis', 45, 28);
                doc.setFontSize(10);
                doc.text(`${results.companyName}`, 45, 35);
                doc.text(`Gegenereerd: ${new Date().toLocaleDateString('nl-NL')}`, 45, 42);
            }

            async createExecutiveSummary(doc, results) {
                let yPos = 65;
                
                // Executive Summary Section
                doc.setFillColor(248, 250, 252);
                doc.rect(10, yPos, 190, 60, 'F');
                
                doc.setTextColor(31, 41, 55);
                doc.setFontSize(16);
                doc.text('EXECUTIVE SUMMARY', 15, yPos + 10);
                
                // KPI Grid
                const kpis = [
                    { label: 'Totale Uitstoot', value: `${results.totalEmissions} ton/jaar`, icon: '🏭' },
                    { label: 'Per Werknemer', value: `${results.perEmployee} ton`, icon: '👤' },
                    { label: 'Compliance', value: 'Volledig', icon: '✅' },
                    { label: 'Besparing Potentie', value: '€50K/jaar', icon: '💰' }
                ];
                
                kpis.forEach((kpi, index) => {
                    const x = 15 + (index * 45);
                    const cardY = yPos + 20;
                    
                    doc.setFillColor(255, 255, 255);
                    doc.rect(x, cardY, 40, 30, 'F');
                    doc.setDrawColor(16, 185, 129);
                    doc.rect(x, cardY, 40, 30, 'S');
                    
                    doc.setTextColor(16, 185, 129);
                    doc.setFontSize(14);
                    doc.text(kpi.value, x + 3, cardY + 10);
                    
                    doc.setTextColor(31, 41, 55);
                    doc.setFontSize(8);
                    doc.text(kpi.label, x + 3, cardY + 18);
                });
            }

            async createDetailedAnalysis(doc, results) {
                doc.addPage();
                let yPos = 20;
                
                // Detailed Analysis Header
                doc.setFillColor(16, 185, 129);
                doc.rect(10, yPos, 190, 8, 'F');
                doc.setTextColor(255, 255, 255);
                doc.setFontSize(12);
                doc.text('GEDETAILLEERDE CO2 ANALYSE', 15, yPos + 6);
                
                yPos += 20;
                
                // Emissions breakdown
                const categories = [
                    { name: 'Zakelijk Vervoer', value: results.breakdown.vehicles, color: [239, 68, 68] },
                    { name: 'Energie Verbruik', value: results.breakdown.energy, color: [245, 158, 11] },
                    { name: 'Woon-werk Verkeer', value: results.breakdown.commuting, color: [16, 185, 129] },
                    { name: 'Zakelijke Reizen', value: results.breakdown.travel, color: [59, 130, 246] }
                ];
                
                categories.forEach((cat, index) => {
                    const percentage = ((cat.value / results.totalEmissions) * 100).toFixed(1);
                    
                    doc.setFillColor(255, 255, 255);
                    doc.rect(10, yPos, 190, 15, 'F');
                    doc.setDrawColor(241, 245, 249);
                    doc.rect(10, yPos, 190, 15, 'S');
                    
                    // Progress bar
                    doc.setFillColor(241, 245, 249);
                    doc.rect(15, yPos + 10, 120, 3, 'F');
                    doc.setFillColor(...cat.color);
                    const barWidth = (parseFloat(percentage) / 100) * 120;
                    doc.rect(15, yPos + 10, barWidth, 3, 'F');
                    
                    // Labels
                    doc.setTextColor(31, 41, 55);
                    doc.setFontSize(10);
                    doc.text(cat.name, 15, yPos + 7);
                    doc.setTextColor(...cat.color);
                    doc.text(`${cat.value} ton (${percentage}%)`, 140, yPos + 7);
                    
                    yPos += 18;
                });
            }

            async createRecommendations(doc, results) {
                let yPos = 160;
                
                // Recommendations section
                doc.setFillColor(16, 185, 129);
                doc.rect(10, yPos, 190, 8, 'F');
                doc.setTextColor(255, 255, 255);
                doc.setFontSize(12);
                doc.text('AANBEVELINGEN & ROI ANALYSE', 15, yPos + 6);
                
                yPos += 20;
                
                if (results.recommendations && results.recommendations.length > 0) {
                    results.recommendations.slice(0, 3).forEach((rec, index) => {
                        doc.setFillColor(248, 250, 252);
                        doc.rect(10, yPos, 190, 25, 'F');
                        
                        doc.setTextColor(31, 41, 55);
                        doc.setFontSize(11);
                        doc.text(rec.action, 15, yPos + 8);
                        
                        doc.setFontSize(9);
                        doc.text(`CO2 besparing: ${rec.impact} ton/jaar`, 15, yPos + 15);
                        doc.text(`Investering: ${rec.cost}`, 15, yPos + 20);
                        doc.text(`Terugverdientijd: ${rec.payback}`, 100, yPos + 15);
                        
                        const priorityColor = rec.priority === 'high' ? [239, 68, 68] : [245, 158, 11];
                        doc.setFillColor(...priorityColor);
                        doc.circle(180, yPos + 12, 6, 'F');
                        
                        yPos += 30;
                    });
                }
            }

            async createFinancialImpact(doc, results) {
                doc.addPage();
                let yPos = 20;
                
                // Financial Impact section
                doc.setFillColor(59, 130, 246);
                doc.rect(10, yPos, 190, 8, 'F');
                doc.setTextColor(255, 255, 255);
                doc.setFontSize(12);
                doc.text('FINANCIELE IMPACT ANALYSE', 15, yPos + 6);
                
                yPos += 20;
                
                // Cost calculations
                const currentCosts = results.totalEmissions * 80; // €80 per ton social cost
                const potential5YearSavings = results.totalEmissions * 200; // Potential savings
                
                // Current costs
                doc.setFillColor(254, 242, 242);
                doc.rect(10, yPos, 90, 40, 'F');
                doc.setTextColor(185, 28, 28);
                doc.setFontSize(11);
                doc.text('HUIDIGE KOSTEN', 15, yPos + 10);
                doc.setFontSize(16);
                doc.text(`€${Math.round(currentCosts).toLocaleString()}`, 15, yPos + 20);
                doc.setFontSize(8);
                doc.text('per jaar (sociale kosten)', 15, yPos + 27);
                
                // Potential savings
                doc.setFillColor(240, 253, 244);
                doc.rect(110, yPos, 90, 40, 'F');
                doc.setTextColor(5, 150, 105);
                doc.setFontSize(11);
                doc.text('BESPARING POTENTIE', 115, yPos + 10);
                doc.setFontSize(16);
                doc.text(`€${Math.round(potential5YearSavings).toLocaleString()}`, 115, yPos + 20);
                doc.setFontSize(8);
                doc.text('over 5 jaar', 115, yPos + 27);
            }

            addWatermark(doc) {
                // Add watermark for free version
                doc.setTextColor(220, 220, 220);
                doc.setFontSize(48);
                doc.text('GRATIS VERSIE', 50, 150, { angle: 45 });
                
                // Add upgrade notice
                doc.setTextColor(107, 114, 128);
                doc.setFontSize(10);
                doc.text('Upgrade naar Professional voor rapporten zonder watermark', 20, 280);
            }
        }

        // ===== GLOBAL FUNCTIONS =====
        
        // Initialize application
        const appState = new AppState();
        const calculator = new Calculator();
        const paymentManager = new PaymentManager();
        const reportGenerator = new ReportGenerator();

        // Navigation functions
        function nextStep() {
            calculator.nextStep();
        }

        function previousStep() {
            calculator.previousStep();
        }

        function startCalculator() {
            calculator.showStep(1);
            document.getElementById('calculator').scrollIntoView({ behavior: 'smooth' });
        }

        // Authentication functions
        function showAuthModal(type = 'login') {
            const modal = document.getElementById('authModal');
            modal.classList.add('active');
            showAuthForm(type);
        }

        function showAuthForm(type) {
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            
            if (type === 'login') {
                loginForm.style.display = 'block';
                registerForm.style.display = 'none';
            } else {
                loginForm.style.display = 'none';
                registerForm.style.display = 'block';
            }
        }

        async function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                showNotification('Vul alle velden in', 'error');
                return;
            }

            showLoadingState('Inloggen...');
            
            try {
                // Simulate login API call
                const response = await fetch('/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });
                
                if (response.ok) {
                    const { user } = await response.json();
                    appState.login(email, user.plan || 'free');
                    closeModal('authModal');
                } else {
                    showNotification('Inloggen mislukt. Controleer uw gegevens.', 'error');
                }
                
            } catch (error) {
                // For demo purposes, simulate successful login
                appState.login(email, 'free');
                closeModal('authModal');
            } finally {
                hideLoadingState();
            }
        }

        async function handleRegister() {
            const company = document.getElementById('registerCompany').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            
            if (!company || !email || !password) {
                showNotification('Vul alle velden in', 'error');
                return;
            }

            if (password.length < 8) {
                showNotification('Wachtwoord moet minimaal 8 karakters zijn', 'error');
                return;
            }

            showLoadingState('Account aanmaken...');
            
            try {
                // Simulate register API call
                const response = await fetch('/api/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password, companyName: company })
                });
                
                if (response.ok) {
                    appState.login(email, 'free');
                    closeModal('authModal');
                    showNotification('Account succesvol aangemaakt! Je hebt 1 gratis rapport per maand.', 'success');
                } else {
                    showNotification('Registratie mislukt. Probeer het opnieuw.', 'error');
                }
                
            } catch (error) {
                // For demo purposes, simulate successful registration
                appState.login(email, 'free');
                closeModal('authModal');
                showNotification('Account succesvol aangemaakt! Je hebt 1 gratis rapport per maand.', 'success');
            } finally {
                hideLoadingState();
            }
        }

        function logout() {
            appState.logout();
        }

        // Payment functions
        function subscribeToPlan(plan) {
            paymentManager.createSubscription(plan);
        }

        function buyOneTimeReport() {
            if (!calculator.results) {
                showNotification('Voltooi eerst de CO2 berekening', 'error');
                startCalculator();
                return;
            }
            showModal('paymentModal');
        }

        function processOneTimePayment() {
            paymentManager.processOneTimePayment();
        }

        function createSubscription(plan) {
            paymentManager.createSubscription(plan);
        }

        // Report functions
        function downloadProfessionalReport(isPaid = false) {
            if (!calculator.results) {
                showNotification('Voltooi eerst de berekening!', 'error');
                startCalculator();
                return;
            }

            if (!appState.user) {
                showAuthModal('register');
                return;
            }

            if (!appState.canDownloadReport() && !isPaid) {
                showModal('paymentModal');
                return;
            }

            reportGenerator.generateProfessionalReport(isPaid);
        }

        function downloadExcelReport() {
            if (!calculator.results) {
                showNotification('Voltooi eerst de berekening!', 'error');
                return;
            }

            // Generate CSV for Excel
            const results = calculator.results;
            const csvContent = this.generateCSVReport(results);
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `CO2-Data-${results.companyName.replace(/\s+/g, '-')}.csv`;
            link.click();
            
            showNotification('Excel data geëxporteerd!', 'success');
        }

        // Demo functions
        function showDemo() {
            // Fill form with demo data
            document.getElementById('companyName').value = 'Demo Bedrijf BV';
            document.getElementById('employees').value = '150-250';
            document.getElementById('industry').value = 'services';
            document.getElementById('carCount').value = '15';
            document.getElementById('carKm').value = '45000';
            document.getElementById('electricity').value = '150000';
            document.getElementById('gas').value = '25000';
            
            startCalculator();
            showNotification('Demo data geladen! Klik door de stappen.', 'info');
        }

        function contactSales() {
            window.open('mailto:sales@carboncomply.nl?subject=Enterprise Interest', '_blank');
        }

        // Utility functions
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.add('active');
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('active');
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type} show`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                ${message}
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, 4000);
        }

        function showLoadingState(message) {
            const loadingOverlay = document.createElement('div');
            loadingOverlay.id = 'loadingOverlay';
            loadingOverlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.7);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10002;
                color: white;
                font-size: 1.2rem;
            `;
            loadingOverlay.innerHTML = `
                <div style="text-align: center;">
                    <div class="spinner" style="width: 40px; height: 40px; margin-bottom: 1rem;"></div>
                    ${message}
                </div>
            `;
            
            document.body.appendChild(loadingOverlay);
        }

        function hideLoadingState() {
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) overlay.remove();
        }

        // Initialize smooth scrolling
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth' });
                    }
                });
            });

            // Close modals when clicking outside
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal')) {
                    e.target.classList.remove('active');
                }
            });

            // Initialize tooltips
            const tooltips = document.querySelectorAll('.tooltip');
            tooltips.forEach(tooltip => {
                tooltip.addEventListener('mouseenter', function() {
                    this.style.position = 'relative';
                });
            });
        });

        // Configuration (you'll need to set these)
        const STRIPE_PUBLISHABLE_KEY = 'pk_test_your_stripe_key_here'; // Replace with your actual key
        
        // Error handling
        window.addEventListener('error', function(e) {
            console.error('Application error:', e.error);
            showNotification('Er is een fout opgetreden. Probeer de pagina te vernieuwen.', 'error');
        });

        // Performance monitoring
        window.addEventListener('load', function() {
            const loadTime = performance.now();
            console.log(`Application loaded in ${Math.round(loadTime)}ms`);
        });
    </script>
</body>
</html>
